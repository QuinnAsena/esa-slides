{
  "hash": "c8a72b19684e28c841630d9700db6aff",
  "result": {
    "markdown": "---\ntitle: \"Modelling palaeoecological community data: a state-space approach\"\nauthor: \"Quinn Asena, Anthony Ives, Jack Williams, and Jonathan Johnson\"\ninstitute: \"UW-Madison\"\ndate: today\nbibliography: refs.bib\nfrom: markdown+emoji\nformat:\n  revealjs:\n    theme: dark\n#    backgroundcolor: \"#44444c\"\n#    fontcolor: \"white\"\n    preview-links: true\n    highlight-style: github\n    slide-number: c/t\n    width: 1600\n    height: 900\ntitle-slide-attributes:\n  data-background-color: \"#1a1e43\"\n---\n\n\n## Is the past recoverable from the data?\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](slide_deck_files/figure-revealjs/vertical-spp-plot-1.png){width=960}\n:::\n:::\n\n\n:::\n::: {.column width=\"50%\"}\n\nPalaeoecologists are concerned with questions such as:\n\n- what are the drivers of community change?\n- what role do  species-environment interactions play?\n- what role do density dependence and species interactions play?\n- how can palaeoecological information inform present and future ecosystem states?\n\n:::\n::::\n\n\n## Palaeoecological proxy data\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\nProxy data typically:\n\n-  comprise mulitple time-series (response): \n  - e.g., pollen, diatoms...\n- include environmental covariates (predictors):\n  - e.g., isotopic data, charcoal data, lake level...\n\n:::\n::: {.column width=\"50%\"}\n\nPose many statistical challenges:\n\n- Uneven sampling through time\n- Time averaging\n- Measurement uncertainty\n- Relative abundances\n\n:::\n::::\n\n## Descriptive approaches\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\nMany descriptive approaches exist for analysing multivariate time-series:\n\n- Cluster analyses: CONISS\n- Ordination: PCA, NMDS...\n- Machine learning: MVRT, LDA (fancy cluster analyses)\n\n<br>\n\n**Descriptive methods allow us to see patterns in the data but not determine potential causes of those patterns.**\n\n:::\n::: {.column width=\"50%\"}\n\n![Jensen _et al.,_ 2020](./images/jensen_coniss_crop.jpg){width=\"85%\"}\n\n:::\n::::\n\n\n\n## Beyond pattern recognition\n\nThe cutting edge in palaeoecology is to establish potential causes of observed patterns in species relative abundances. For example, are observed patterns driven by:\n\n- species interactions?\n- climate variability?\n- fire regime?\n- ...\n\nThis is what we want to know if we are to use palaeoecology to inform management of contemporary ecosystems or inform potential future ecosystem states. No easy task!\n\n## State-space modelling\n\nState-space modelling goes beyond descriptive approaches and attempts to estimate:\n\n- autoregressive / density dependent processes \n- interspecific interactions ($C$ matrix)\n- species-environment interactions ($B$ vector)\n- combinations of the above\n\n\n## State-space modelling\n\nState-space modelling attempts to predict the \"true\" unobservable state of a system from observable variables. It does so via two equations, one that models the _process of the system_:\n\n<br>\nProcess equation:\n\n$$\nZ = B0 + C(Z_{t-1} - B0 - BX_{t-1}) + BX_t\n$$\n\nand one that models the _observations_ from the system:\n\n<br>\n\nObservation equation:\n\n$$\nY_t = Multinomial(Z_t)\n$$\n\n## State-space modelling\n\nState-space models are not new to ecology and have been used for:\n\n- estimating animal populations\n- animal movement\n- plant cover data\n- and much more\n\nHowever, state-space models are not well explored in palaeoecology.\n\n## State-space modelling\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\nThis new variant of a state-space model:\n\n- uses a multinomial distribution: accepts raw count data\n- accepts multiple predictor data streams in the same model: e.g., isotopic data, charcoal accumulation rates, fungal spores...\n- simultaneously fits multiple coefficients\n- models autocorrelation structure\n\n:::\n\n::: {.column width=\"50%\"}\n\n<br>\n\n$$\nZ = B0 + C(Z_{t-1} - B0 - BX_{t-1}) + BX_t\n$$\n\n<br>\n\n$$\nY_t = Multinomial(Z_t)\n$$\n\n:::\n::::\n\n<br>\n\n**Can be used to assess a range of possible causes of observed patterns in palaeo-data.**\n\n\n## Empirical example\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\nDemonstrating a three-taxon model from Sunfish Pond:\n\n- unpublished data: not presenting the dataset, focusing on the modelling approach (Johnson _et al.,_ unpub)\n\n- ACES project interested in abrupt transitions between dominant species\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-5c1e76e4c6deae074dc4\" style=\"width:960px;height:480px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5c1e76e4c6deae074dc4\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"setView\":[[41.6433326,-76.69907329999999],5,[]],\"calls\":[{\"method\":\"addMarkers\",\"args\":[41.6433326,-76.69907329999999,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},\"Sunfish Pond\",null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]}],\"limits\":{\"lat\":[41.6433326,41.6433326],\"lng\":[-76.69907329999999,-76.69907329999999]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n:::\n::::\n\n## Jonathon Johnson (JJ)\n\n![](./images/johnson-jonathan-2020.jpg){fig-align=\"center\"}\n\n## Empirical example\n\nThis example is a three-taxon model:\n\n- two focal species (_Betula_ and _Quercus_)\n- third 'species' is an aggregate of all other species\n- we fit species interactions\n- estimate species change through time\n\nRemember, this is a multinomial problem which accounts for unavoidable correlations in frequency data.\n\n## Time-forward model enables uneven intervals\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Johnson _et al.,_ unpublished](slide_deck_files/figure-revealjs/plot-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n## Species interaction estimates\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n\n$C$ matrix\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n         other Quercus Betula\nother   -0.074   0.000  0.000\nQuercus  0.000  -0.006  0.121\nBetula   0.000  -0.702 -0.459\n```\n:::\n:::\n\n\n<br>\n\n- columns = abundance; rows = change in abundance\n\n- density dependence on the diagonal\n\n- _Quercus-Betula_ -0.7 means that abundance of _Quercus_ affects the change in _Betula_ abundance\n\n\n:::\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](slide_deck_files/figure-revealjs/verticalplot-1.png){width=960}\n:::\n:::\n\n\n:::\n::::\n\n\n## Estimating the effect of covariates\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\nEstimate of change over time\n\n$B$ vector\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n other Quercus Betula\n     0   0.048 -0.532\n```\n:::\n:::\n\n\n<br>\n\nOverall:\n\n- _Quercus_ increases with time\n- _Betula_ decreases with time\n- estimates are relative to \"other\" taxa\n\n:::\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](slide_deck_files/figure-revealjs/verticalplotb-1.png){width=960}\n:::\n:::\n\n\n:::\n::::\n\n## Evaluating the model with simulated data\n\n- We cannot determine the accuracy of fitted coefficients empirically from palaeoecological data.\n\n- Simulation experiments are used to assess the success of recovering parameters:\n  1. data are simulated under known conditions with replication\n  2. the model is fit to the simulated replicate datasets\n  3. fitted models are assessed for how well input parameters are recovered\n\n\n## Evaluating the model with simulated data\n\n$C$ matrix estimates vs inputs\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](slide_deck_files/figure-revealjs/summarycdat2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n## Evaluating the model with simulated data {visibility=\"hidden\"}\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n$C$ matrix fit to the pollen data\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n         other Quercus Betula\nother   -0.074   0.000  0.000\nQuercus  0.000  -0.006  0.121\nBetula   0.000  -0.702 -0.459\n```\n:::\n:::\n\n<br>\n\n$B$ vector fit to the pollen data\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n other Quercus Betula\n     0   0.048 -0.532\n```\n:::\n:::\n\n\n:::\n::: {.column width=\"50%\"}\n\n$C$ matrix fit to the simulated data\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n         other Quercus Betula\nother   -0.926   0.000  0.000\nQuercus  0.000  -0.071 -0.080\nBetula   0.000   0.243  0.233\n```\n:::\n:::\n\n<br>\n\n$B$ vector fit to the simulated data\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n      other Quercus Betula\nother     0   0.039 -0.106\n```\n:::\n:::\n\n\n<br>\n\n- 112 reps\n- average difference between input and fitted parameters\n\n:::\n::::\n\n## Hypothesis testing\n\nWe cannot determine with certainty, outside of simulation, causation from palaeo-data.\n\nWhat we can do is:\n\n- set up multiple working hypothese (Chamberlin, 1897)\n- couple descriptive methods with inferrential ones\n- assess which results lend support to the likelihood of each hypothesis being true\n\n_Given the data at hand_ the interaction matrix ($C$) indicates some competition between _Quercus_ and _Betula_.  Such an inference lends support to one hypothesis.\n\n## Acknowledgements\n\nAces team:\n\n- Jack Williams, Tony Ives, Angie Perotti, Nora Schlenker, Sam Wiles, Amanda Toomey Bryan Schuman, David Nelson, Jonathon Johnson\n\n\n- National Science Foundation\n- UW-Madison\n\n::: footer\n![](./images/crest-color/crest-color/color-UWcrest-print.png){width=60} ![](./images/NSF_Official_logo_High_Res_1200ppi.png){width=100}\n:::",
    "supporting": [
      "slide_deck_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"slide_deck_files/libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"slide_deck_files/libs/jquery-1.12.4/jquery.min.js\"></script>\r\n<link href=\"slide_deck_files/libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"slide_deck_files/libs/leaflet-1.3.1/leaflet.js\"></script>\r\n<link href=\"slide_deck_files/libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\r\n<script src=\"slide_deck_files/libs/proj4-2.6.2/proj4.min.js\"></script>\r\n<script src=\"slide_deck_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\r\n<link href=\"slide_deck_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"slide_deck_files/libs/leaflet-binding-2.1.2/leaflet.js\"></script>\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}